# Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."

---

## Задание 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и 
виртуализации на основе ОС.

Решение:

Полная виртуализация устройства виртуальной машины полностью эмулируют работу оборудования, вплоть до регистров, 
памяти и т.д. В этом случае гостевая ОС не подозревает о такой подмене. При этом ядро гостевой ОС и хостовой ОС могут 
координально отличаться.

Паравиртуализация - гипервизор паравиртуализации не скрывает себя от гостевых операционных систем. Но в этом случае 
они должны быть подготовлены к работе с этой системой. В результате, применение паравиртуализации требует модификации 
кода гостевой ОС на уровне ядра, что позволяет ей общаться с гипервизором на более высоком уровне, обеспечивая более 
высокое быстродействие. Гипервизор предоставляет гостевой ОС специальный программный интерфейс (API), исключающий 
необходимость прямого обращения к таким ресурсам, как, например, таблицы страниц памяти.   

Виртуализация на основе ОС - обеспечивает разделение одного физического сервера на несколько защищенных 
виртуализированных частей (контейнеров), каждая из которых представляется для владельца как один сервер. Виртуальная 
машина представляет собой окружение для приложений, запускаемых изолированно. При этом виртуальные контейнеры, 
работающие на уровне ядра ОС, крайне мало теряют в быстродействии по сравнению с производительностью «реального» 
сервера, что позволяет запускать в рамках одного физического хоста десятки и сотни виртуальных контейнеров. Однако 
существуют определенные ограничения по запуску виртуальных машин с разными версиями ядра ОС. 

## Задание 2

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и 
виртуализации на основе ОС.

Организация серверов:
````
физические сервера,
паравиртуализация,
виртуализация уровня ОС.
````
Условия использования:
````
Высоконагруженная база данных, чувствительная к отказу.
Различные web-приложения.
Windows системы для использования бухгалтерским отделом.
Системы, выполняющие высокопроизводительные расчеты на GPU.
Опишите, почему вы выбрали к каждому целевому использованию такую организацию.
````
Решение:

Высоконагруженная база данных, чувствительная к отказу - физический сервер. Любая дополнительная виртуализация тратит 
драгоценные ресурсы. Любая виртуализация повышает вероятность отказа из-за программных ошибок. 

Различные web-приложения - виртуализация на уровне ОС. Для запуска большого количества Web-приложений, которые регулярно
обновляются, логичнее запускать в контейнерах. Большое количество контейнеров можно автоматизировать оркестрацию. И за 
счет этого сократить время запуска окружения для обновленных приложений.

Windows системы для использования бухгалтерским отделом - паравиртуализация. Для данной задачи вполне достаточно 
паравиртуализации, т.к. нет большой нагрузки и при этом есть возможность создать среду для запуска бухгалтерского софта. 

Системы, выполняющие высокопроизводительные расчеты на GPU - физический сервер, т.к. любая виртуализация снижает 
производительность системы. Высокопроизводительные системы, как правило, нацелены на выполнение одной задачи, поэтому 
нет смысла разделения ресурсов между задачами. Наоборот необходимо заточить сервер на выполнение конкретной задачи.

## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based 
инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного 
механизма создания резервных копий.
2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) 
инфраструктуры на базе Linux и Windows виртуальных машин.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

Решение:

Сценарий 1 - Virtualbox и Vagrant и Ansible. Эта связка поможет создать большое количество ВМ с предварительной их
настройкой и установкой ПО. Данную связку можно использовать как для Windows, так и для Linux. 
Сценарий 2 - KVM и XEN, open source решения паравиртуализации для ВМ Linux и Windows. Паравиртуализация требует меньше 
накладных расходов физических машин.  
Сценарий 3 - Пиравиртуализация на базе Hiper-V. Использую, хост ОС Windows, и гостевые ОС Windows, тогда это решение 
будет с минимальными накладными расходами. 
Сценарий 4 - Виртуализация уровня ОС. Самый быстрый вариант развертывания окружения для тестирования. Хост ОС Linux.

## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

Решение:

Проблемы гетерогенной среды:  
       - содержать несколько команд администрирования для разных систем (кадровые издержки).  
       - гораздо ниже масштабируемость, придется масштабировать 2 (или более) системы.  
       - сложность при выделении и управлении ресурсами.  
       - финансовые затраты, так как необходимо содержать несколько систем одновременно (если считать платные версии).  
       - проблемы миграции между разными системами, + полное дублирование всей инфраструктуры под 2(или более) системы виртуализации  
       - если бой и тест в разных системах, то отлавливать "баги" сложнее